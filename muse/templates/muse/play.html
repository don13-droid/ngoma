{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Modern Music Player</title>
  <link rel="stylesheet" href="{% static 'muse/css/player.css' %}" />
      <link rel="stylesheet" href="{% static 'muse/css/font-awesome.min.css' %}" />
<link rel="stylesheet" href="{% static 'muse/css/font-awesome.css' %}" />

</head>
<body>
  <div class="caption">üèÖ Featured Player</div>

<div class="player-container">
  <!-- üéµ Music Player -->
  <div class="player">
    <div class="album-art">
      <img id="albumArt" src="" alt="Album Art" />
    </div>
    <div class="track-info">
      <h2 id="songTitle"></h2>
      <p id="artistName"></p>
    </div>
    <audio id="audio" src="" controls></audio>
    <div class="controls">
      <button id="prev"><i class="fa fa-backward"></i></button>
      <button id="playPause"><i class="fa fa-play"></i></button>
      <button id="next"><i class="fa fa-forward"></i></button>
    </div>
    <div class="playlist">
      <ul id="songList">
        {% for song in songs %}
          <li data-index="{{ forloop.counter0 }}">{{ song.song_name }} ‚Äî {{ song.artist }}
              {% if song.artist.verification_icon_color %}
                  <i class="fa fa-check-circle" style="color: {{ song.artist.verification_icon_color }}"></i>{% endif %}
</li>
        {% endfor %}
      </ul>
    <!-- üîÅ Recommended Songs -->
    </div>
  </div>

  <!-- üí¨ Comment Section -->
  <div class="comments-section">
    <h3>Comments ({{ comments|length }})</h3>
    {% for comment in comments %}
    <div class="comment" data-id="{{ comment.id }}">
    {% if comment.user.user.profile_picture %}
      <img src="{{ comment.user.user.profile_picture.url }}" alt="" class="avatar" />
    {% else %}
    <img src="" alt="" class="avatar" />
    {% endif %}
      <div class="comment-body">
        <div class="meta">
          <span class="username">
              {{ comment.user }} {% if comment.user.verification_icon_color %}
                  <i class="fa fa-check-circle" style="color: {{ comment.user.verification_icon_color }}">

                  </i>{% endif %}

          </span>
          <span class="date">{{ comment.created }}</span>
        </div>
        <p>{{ comment.body }}</p>
        <div class="actions">
          <button class="like-comment" data-url="{% url 'muse:increment_comment_likes' %}" data-id="{{ comment.id }}">
            ‚ù§Ô∏è {{ comment.likes.count }}
          </button>
          <button class="toggle-replies">View Replies ({{ comment.replies.count }})</button>
        </div>
        <div class="replies hidden">
          {% for reply in comment.replies.all %}
          <div class="reply">
            <span class="username">{{ reply.user.display_name|safe }}</span>:
            <span class="body">{{ reply.body }}</span>
          </div>
          {% endfor %}
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
</div>
<div class="recommended">
  <h4>Recommended for You</h4>
  <ul id="recommendedList">
    {% for rec in recommended_songs %}
    <li data-src="{{ rec.song_file.url }}">
      <img src="{{ rec.song_art.url }}" alt="Cover" class="rec-cover" />
      <div class="rec-info">
        <p class="rec-title">{{ rec.song_name }}</p>
        <p class="rec-artist">{{ rec.artist.display_name|safe }}</p>
      </div>
      <button class="rec-play">‚ñ∂</button>
    </li>
    {% endfor %}
  </ul>
</div>
<script>
  const songs = [
    {% for song in songs %}
    {
      song_name: "{{ song.song_name }}",
      song_art: { url: "{{ song.song_art.url }}" },
      artist: { display_name: "{{ song.artist}}" },
      src: "{{ song.song_file.url }}"
    },
    {% endfor %}
  ];
</script>
<script src="{% static 'muse/js/script.js' %}"></script>
</body>
</html>
